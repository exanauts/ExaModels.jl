<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API Manual · ExaModels.jl</title><meta name="title" content="API Manual · ExaModels.jl"/><meta property="og:title" content="API Manual · ExaModels.jl"/><meta property="twitter:title" content="API Manual · ExaModels.jl"/><meta name="description" content="Documentation for ExaModels.jl."/><meta property="og:description" content="Documentation for ExaModels.jl."/><meta property="twitter:description" content="Documentation for ExaModels.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="ExaModels.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">ExaModels.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../simd/">Mathematical Abstraction</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Tutorial</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../guide/">Getting Started</a></li><li><a class="tocitem" href="../performance/">Performance Tips</a></li><li><a class="tocitem" href="../gpu/">CPU and GPU acceleration</a></li><li><a class="tocitem" href="../parameters/">Parameters</a></li><li><a class="tocitem" href="../develop/">Developing Extensions</a></li><li><a class="tocitem" href="../quad/">Example: Quadrotor</a></li><li><a class="tocitem" href="../distillation/">Example: Distillation Column</a></li><li><a class="tocitem" href="../opf/">Example: Optimal Power Flow</a></li></ul></li><li><a class="tocitem" href="../jump/">JuMP Interface (experimental)</a></li><li class="is-active"><a class="tocitem" href>API Manual</a></li><li><a class="tocitem" href="../ref/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API Manual</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API Manual</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/exanauts/ExaModels.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/exanauts/ExaModels.jl/blob/main/docs/src/core.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="ExaModels"><a class="docs-heading-anchor" href="#ExaModels">ExaModels</a><a id="ExaModels-1"></a><a class="docs-heading-anchor-permalink" href="#ExaModels" title="Permalink"></a></h1><article><details class="docstring" open="true"><summary id="ExaModels.ExaModels"><a class="docstring-binding" href="#ExaModels.ExaModels"><code>ExaModels.ExaModels</code></a> — <span class="docstring-category">Module</span></summary><section><div><pre><code class="language-julia hljs">ExaModels</code></pre><p>An algebraic modeling and automatic differentiation tool in Julia Language, specialized for SIMD abstraction of nonlinear programs.</p><p>For more information, please visit https://github.com/exanauts/ExaModels.jl</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/ExaModels.jl#L1-L7">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.AdjointNode1"><a class="docstring-binding" href="#ExaModels.AdjointNode1"><code>ExaModels.AdjointNode1</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">AdjointNode1{F, T, I}</code></pre><p>A node with one child for first-order forward pass tree</p><p><strong>Fields:</strong></p><ul><li><code>x::T</code>: function value</li><li><code>y::T</code>: first-order sensitivity</li><li><code>inner::I</code>: children</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/graph.jl#L152-L161">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.AdjointNode2"><a class="docstring-binding" href="#ExaModels.AdjointNode2"><code>ExaModels.AdjointNode2</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">AdjointNode2{F, T, I1, I2}</code></pre><p>A node with two children for first-order forward pass tree</p><p><strong>Fields:</strong></p><ul><li><code>x::T</code>: function value</li><li><code>y1::T</code>: first-order sensitivity w.r.t. first argument</li><li><code>y2::T</code>: first-order sensitivity w.r.t. second argument</li><li><code>inner1::I1</code>: children #1</li><li><code>inner2::I2</code>: children #2</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/graph.jl#L167-L178">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.AdjointNodeSource"><a class="docstring-binding" href="#ExaModels.AdjointNodeSource"><code>ExaModels.AdjointNodeSource</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">AdjointNodeSource{VT}</code></pre><p>A source of <code>AdjointNode</code>. <code>adjoint_node_source[i]</code> returns an <code>AdjointNodeVar</code> at index <code>i</code>.</p><p><strong>Fields:</strong></p><ul><li><code>inner::VT</code>: variable vector</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/graph.jl#L200-L207">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.AdjointNodeVar"><a class="docstring-binding" href="#ExaModels.AdjointNodeVar"><code>ExaModels.AdjointNodeVar</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">AdjointNodeVar{I, T}</code></pre><p>A variable node for first-order forward pass tree</p><p><strong>Fields:</strong></p><ul><li><code>i::I</code>: index</li><li><code>x::T</code>: value</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/graph.jl#L186-L194">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.AdjointNull"><a class="docstring-binding" href="#ExaModels.AdjointNull"><code>ExaModels.AdjointNull</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">Null</code></pre><p>A null node</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/graph.jl#L20-L24">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.Compressor"><a class="docstring-binding" href="#ExaModels.Compressor"><code>ExaModels.Compressor</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">Compressor{I}</code></pre><p>Data structure for the sparse index</p><p><strong>Fields:</strong></p><ul><li><code>inner::I</code>: stores the sparse index as a tuple form</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/simdfunction.jl#L3-L10">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.ExaCore"><a class="docstring-binding" href="#ExaModels.ExaCore"><code>ExaModels.ExaCore</code></a> — <span class="docstring-category">Type</span></summary><section><div><p>ExaCore([array_eltype::Type; backend = backend, minimize = true])</p><p>Returns an intermediate data object <code>ExaCore</code>, which later can be used for creating <code>ExaModel</code></p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using ExaModels

julia&gt; c = ExaCore()
An ExaCore

  Float type: ...................... Float64
  Array type: ...................... Vector{Float64}
  Backend: ......................... Nothing

  number of objective patterns: .... 0
  number of constraint patterns: ... 0

julia&gt; c = ExaCore(Float32)
An ExaCore

  Float type: ...................... Float32
  Array type: ...................... Vector{Float32}
  Backend: ......................... Nothing

  number of objective patterns: .... 0
  number of constraint patterns: ... 0

julia&gt; using CUDA

julia&gt; c = ExaCore(Float32; backend = CUDABackend())
An ExaCore

  Float type: ...................... Float32
  Array type: ...................... CUDA.CuArray{Float32, 1, CUDA.DeviceMemory}
  Backend: ......................... CUDA.CUDAKernels.CUDABackend

  number of objective patterns: .... 0
  number of constraint patterns: ... 0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/nlp.jl#L156-L197">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.ExaModel-Tuple{C} where C&lt;:ExaCore"><a class="docstring-binding" href="#ExaModels.ExaModel-Tuple{C} where C&lt;:ExaCore"><code>ExaModels.ExaModel</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">ExaModel(core)</code></pre><p>Returns an <code>ExaModel</code> object, which can be solved by nonlinear optimization solvers within <code>JuliaSmoothOptimizer</code> ecosystem, such as <code>NLPModelsIpopt</code> or <code>MadNLP</code>.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using ExaModels

julia&gt; c = ExaCore();                      # create an ExaCore object

julia&gt; x = variable(c, 1:10);              # create variables

julia&gt; objective(c, x[i]^2 for i in 1:10); # set objective function

julia&gt; m = ExaModel(c)                     # creat an ExaModel object
An ExaModel{Float64, Vector{Float64}, ...}

  Problem name: Generic
   All variables: ████████████████████ 10     All constraints: ⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅ 0
            free: ████████████████████ 10                free: ⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅ 0
           lower: ⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅ 0                lower: ⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅ 0
           upper: ⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅ 0                upper: ⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅ 0
         low/upp: ⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅ 0              low/upp: ⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅ 0
           fixed: ⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅ 0                fixed: ⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅ 0
          infeas: ⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅ 0               infeas: ⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅ 0
            nnzh: ( 81.82% sparsity)   10              linear: ⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅ 0
                                                    nonlinear: ⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅⋅ 0
                                                         nnzj: (------% sparsity)
                                                     lin_nnzj: (------% sparsity)
                                                     nln_nnzj: (------% sparsity)

julia&gt; using NLPModelsIpopt

julia&gt; result = ipopt(m; print_level=0)    # solve the problem
&quot;Execution stats: first-order stationary&quot;
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/nlp.jl#L271-L311">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.Node1"><a class="docstring-binding" href="#ExaModels.Node1"><code>ExaModels.Node1</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">Node1{F, I}</code></pre><p>A node with one child for symbolic expression tree</p><p><strong>Fields:</strong></p><ul><li><code>inner::I</code>: children</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/graph.jl#L83-L90">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.Node2"><a class="docstring-binding" href="#ExaModels.Node2"><code>ExaModels.Node2</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">Node2{F, I1, I2}</code></pre><p>A node with two children for symbolic expression tree</p><p><strong>Fields:</strong></p><ul><li><code>inner1::I1</code>: children #1</li><li><code>inner2::I2</code>: children #2</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/graph.jl#L95-L103">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.Null"><a class="docstring-binding" href="#ExaModels.Null"><code>ExaModels.Null</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">Null</code></pre><p>A null node</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/graph.jl#L10-L14">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.ParIndexed"><a class="docstring-binding" href="#ExaModels.ParIndexed"><code>ExaModels.ParIndexed</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">ParIndexed{I, J}</code></pre><p>A parameterized data node</p><p><strong>Fields:</strong></p><ul><li><code>inner::I</code>: parameter for the data</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/graph.jl#L70-L77">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.ParSource"><a class="docstring-binding" href="#ExaModels.ParSource"><code>ExaModels.ParSource</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">ParSource</code></pre><p>A source of parameterized data</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/graph.jl#L62-L67">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.ParameterSubexpr"><a class="docstring-binding" href="#ExaModels.ParameterSubexpr"><code>ExaModels.ParameterSubexpr</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">ParameterSubexpr</code></pre><p>A parameter-only subexpression whose values are computed once when parameters are set, not at every function evaluation. Use this for expressions that depend only on parameters (θ), not on variables (x). Values are automatically recomputed when <code>set_parameter!</code> is called.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/nlp.jl#L67-L73">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.ReducedSubexpr"><a class="docstring-binding" href="#ExaModels.ReducedSubexpr"><code>ExaModels.ReducedSubexpr</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">ReducedSubexpr</code></pre><p>A reduced-form subexpression that substitutes the expression directly when indexed. No auxiliary variables or constraints are created - the expression is inlined.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/nlp.jl#L46-L51">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.SIMDFunction"><a class="docstring-binding" href="#ExaModels.SIMDFunction"><code>ExaModels.SIMDFunction</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">SIMDFunction(gen::Base.Generator, o0 = 0, o1 = 0, o2 = 0)</code></pre><p>Returns a <code>SIMDFunction</code> using the <code>gen</code>.</p><p><strong>Arguments:</strong></p><ul><li><code>gen</code>: an iterable function specified in <code>Base.Generator</code> format</li><li><code>o0</code>: offset for the function evaluation</li><li><code>o1</code>: offset for the derivative evalution</li><li><code>o2</code>: offset for the second-order derivative evalution</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/simdfunction.jl#L30-L40">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.SecondAdjointNode1"><a class="docstring-binding" href="#ExaModels.SecondAdjointNode1"><code>ExaModels.SecondAdjointNode1</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">SecondAdjointNode1{F, T, I}</code></pre><p>A node with one child for second-order forward pass tree</p><p><strong>Fields:</strong></p><ul><li><code>x::T</code>: function value</li><li><code>y::T</code>: first-order sensitivity</li><li><code>h::T</code>: second-order sensitivity</li><li><code>inner::I</code>: DESCRIPTION</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/graph.jl#L223-L233">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.SecondAdjointNode2"><a class="docstring-binding" href="#ExaModels.SecondAdjointNode2"><code>ExaModels.SecondAdjointNode2</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">SecondAdjointNode2{F, T, I1, I2}</code></pre><p>A node with one child for second-order forward pass tree</p><p><strong>Fields:</strong></p><ul><li><code>x::T</code>: function value</li><li><code>y1::T</code>: first-order sensitivity w.r.t. first argument</li><li><code>y2::T</code>: first-order sensitivity w.r.t. first argument</li><li><code>h11::T</code>: second-order sensitivity w.r.t. first argument</li><li><code>h12::T</code>: second-order sensitivity w.r.t. first and second argument</li><li><code>h22::T</code>: second-order sensitivity w.r.t. second argument</li><li><code>inner1::I1</code>: children #1</li><li><code>inner2::I2</code>: children #2</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/graph.jl#L240-L254">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.SecondAdjointNodeSource"><a class="docstring-binding" href="#ExaModels.SecondAdjointNodeSource"><code>ExaModels.SecondAdjointNodeSource</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">SecondAdjointNodeSource{VT}</code></pre><p>A source of <code>AdjointNode</code>. <code>adjoint_node_source[i]</code> returns an <code>AdjointNodeVar</code> at index <code>i</code>.</p><p><strong>Fields:</strong></p><ul><li><code>inner::VT</code>: variable vector</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/graph.jl#L280-L287">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.SecondAdjointNodeVar"><a class="docstring-binding" href="#ExaModels.SecondAdjointNodeVar"><code>ExaModels.SecondAdjointNodeVar</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">SecondAdjointNodeVar{I, T}</code></pre><p>A variable node for first-order forward pass tree</p><p><strong>Fields:</strong></p><ul><li><code>i::I</code>: index</li><li><code>x::T</code>: value</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/graph.jl#L266-L274">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.SecondAdjointNull"><a class="docstring-binding" href="#ExaModels.SecondAdjointNull"><code>ExaModels.SecondAdjointNull</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">Null</code></pre><p>A null node</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/graph.jl#L27-L31">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.StochasticExaModel"><a class="docstring-binding" href="#ExaModels.StochasticExaModel"><code>ExaModels.StochasticExaModel</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">StochasticExaModel{T, VT, M}</code></pre><p>A stochastic optimization model where all scenarios are fused into a single ExaModel. Evaluates all scenarios in ONE kernel launch.</p><p><strong>Fields</strong></p><ul><li><code>model::M</code>: Single fused ExaModel containing all scenarios</li><li><code>ns::Int</code>: Number of scenarios</li><li><code>nv::Int</code>: Recourse variables per scenario</li><li><code>nd::Int</code>: Design (shared) variables</li><li><code>nc::Int</code>: Constraints per scenario</li><li><code>nθ::Int</code>: Parameters per scenario</li><li><code>nnzj_per_scenario::Int</code>: Jacobian nonzeros per scenario (approximate)</li><li><code>nnzh_per_scenario::Int</code>: Hessian nonzeros per scenario (approximate)</li></ul><p><strong>Structure</strong></p><ul><li>Total variables: ns*nv + nd</li><li>Total constraints: ns*nc</li><li>Global variable layout: [v₁; v₂; ...; vₛ; d]</li><li>Global constraint layout: [c₁; c₂; ...; cₛ]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/stochastic.jl#L27-L48">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.StochasticExaModel-Tuple{Function, Int64, Int64, Int64, Vector{&lt;:AbstractVector}}"><a class="docstring-binding" href="#ExaModels.StochasticExaModel-Tuple{Function, Int64, Int64, Int64, Vector{&lt;:AbstractVector}}"><code>ExaModels.StochasticExaModel</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">StochasticExaModel(build, nd, nv, ns, θ_sets; backend=nothing)</code></pre><p>Build a stochastic model where all scenarios are fused into a single ExaModel.</p><p>All scenarios share ONE compiled expression pattern, achieving maximum GPU efficiency. This requires scenarios to have identical structure.</p><p><strong>Arguments</strong></p><ul><li><code>build::Function</code>: Function <code>(c, d, v, θ, ns, nv, nθ) -&gt; nothing</code><ul><li><code>c</code>: ExaCore</li><li><code>d</code>: Variable handle for design variables (indices 1:nd)</li><li><code>v</code>: Variable handle for ALL recourse variables (indices 1:ns<em>nv)     Scenario i&#39;s vars are at indices (i-1)</em>nv+1 : i*nv</li><li><code>θ</code>: Parameter handle for ALL parameters (length ns<em>nθ)     Scenario i&#39;s params are at indices (i-1)</em>nθ+1 : i*nθ</li><li><code>ns, nv, nθ</code>: dimensions for building iteration data</li></ul></li><li><code>nd::Int</code>: Number of design variables</li><li><code>nv::Int</code>: Number of recourse variables per scenario</li><li><code>ns::Int</code>: Number of scenarios</li><li><code>θ_sets::Vector{&lt;:AbstractVector}</code>: Parameter vectors for each scenario</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">ns, nv, nd, nθ = 100, 5, 2, 3
θ_sets = [rand(nθ) for _ in 1:ns]

model = StochasticExaModel(nd, nv, ns, θ_sets) do c, d, v, θ, ns, nv, nθ
    obj_data = [(i, j, (i-1)*nv + j, (i-1)*nθ) for i in 1:ns for j in 1:nv]
    objective(c, θ[θ_off + 1] * v[v_idx]^2 for (i, j, v_idx, θ_off) in obj_data)

    con_data = [(i, j, (i-1)*nv + j, (i-1)*nθ) for i in 1:ns for j in 1:nv]
    constraint(c, v[v_idx] + d[1] - θ[θ_off + 3] for (i, j, v_idx, θ_off) in con_data)
end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/stochastic.jl#L84-L119">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.Subexpr"><a class="docstring-binding" href="#ExaModels.Subexpr"><code>ExaModels.Subexpr</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">Subexpr</code></pre><p>A subexpression that has been lifted to auxiliary variables with defining equality constraints. Can be indexed like a Variable to get <code>Var</code> nodes for use in objectives and constraints.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/nlp.jl#L25-L30">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.Var"><a class="docstring-binding" href="#ExaModels.Var"><code>ExaModels.Var</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">Var{I}</code></pre><p>A variable node for symbolic expression tree</p><p><strong>Fields:</strong></p><ul><li><code>i::I</code>: (parameterized) index </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/graph.jl#L44-L51">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.VarSource"><a class="docstring-binding" href="#ExaModels.VarSource"><code>ExaModels.VarSource</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">VarSource</code></pre><p>A source of variable nodes</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/graph.jl#L35-L40">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.WrapperNLPModel-Tuple{Any, Any}"><a class="docstring-binding" href="#ExaModels.WrapperNLPModel-Tuple{Any, Any}"><code>ExaModels.WrapperNLPModel</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">WrapperNLPModel(VT, m)</code></pre><p>Returns a <code>WrapperModel{T,VT}</code> wrapping <code>m &lt;: AbstractNLPModel{T}</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/utils.jl#L47-L51">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.WrapperNLPModel-Tuple{Any}"><a class="docstring-binding" href="#ExaModels.WrapperNLPModel-Tuple{Any}"><code>ExaModels.WrapperNLPModel</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">WrapperNLPModel(m)</code></pre><p>Returns a <code>WrapperModel{Float64,Vector{64}}</code> wrapping <code>m</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/utils.jl#L40-L44">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels._recompute_param_subexprs!-Tuple{ExaCore}"><a class="docstring-binding" href="#ExaModels._recompute_param_subexprs!-Tuple{ExaCore}"><code>ExaModels._recompute_param_subexprs!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">_recompute_param_subexprs!(c::ExaCore)</code></pre><p>Re-evaluates all parameter-only subexpressions and updates their cached values in θ. Called automatically by <code>set_parameter!</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/nlp.jl#L590-L595">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.constraint!-Union{Tuple{C}, Tuple{C, Any, Any, Any}} where C&lt;:ExaCore"><a class="docstring-binding" href="#ExaModels.constraint!-Union{Tuple{C}, Tuple{C, Any, Any, Any}} where C&lt;:ExaCore"><code>ExaModels.constraint!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">constraint!(c, c1, expr, pars)</code></pre><p>Expands the existing constraint <code>c1</code> in <code>c</code> by adding addtional constraints terms specified by <code>expr</code> and <code>pars</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/nlp.jl#L795-L799">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.constraint!-Union{Tuple{C}, Tuple{C, Any, Base.Generator}} where C&lt;:ExaCore"><a class="docstring-binding" href="#ExaModels.constraint!-Union{Tuple{C}, Tuple{C, Any, Base.Generator}} where C&lt;:ExaCore"><code>ExaModels.constraint!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">constraint!(c::C, c1, gen::Base.Generator) where {C&lt;:ExaCore}</code></pre><p>Expands the existing constraint <code>c1</code> in <code>c</code> by adding additional constraint terms specified by a <code>generator</code>.</p><p><strong>Arguments</strong></p><ul><li><code>c::C</code>: The model to which the constraints are added.</li><li><code>c1</code>: An initial constraint value or expression.</li><li><code>gen::Base.Generator</code>: A generator that produces the pair of constraint index and term to be added.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using ExaModels

julia&gt; c = ExaCore();

julia&gt; x = variable(c, 10);

julia&gt; c1 = constraint(c, x[i] + x[i+1] for i=1:9; lcon = -1, ucon = (1+i for i=1:9));

julia&gt; constraint!(c, c1, i =&gt; sin(x[i+1]) for i=4:6)
Constraint Augmentation

  s.t. (...)
       g♭ ≤ (...) + ∑_{p ∈ P} h(x,θ,p) ≤ g♯

  where |P| = 3</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/nlp.jl#L757-L785">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.constraint-Union{Tuple{C}, Tuple{T}, Tuple{C, Any}} where {T, C&lt;:(ExaCore{T, VT} where VT&lt;:AbstractVector{T})}"><a class="docstring-binding" href="#ExaModels.constraint-Union{Tuple{C}, Tuple{T}, Tuple{C, Any}} where {T, C&lt;:(ExaCore{T, VT} where VT&lt;:AbstractVector{T})}"><code>ExaModels.constraint</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">constraint(core, n; start = 0, lcon = 0,  ucon = 0)</code></pre><p>Adds empty constraints of dimension n, so that later the terms can be added with <code>constraint!</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/nlp.jl#L724-L728">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.constraint-Union{Tuple{C}, Tuple{T}, Tuple{C, Base.Generator}} where {T, C&lt;:(ExaCore{T, VT} where VT&lt;:AbstractVector{T})}"><a class="docstring-binding" href="#ExaModels.constraint-Union{Tuple{C}, Tuple{T}, Tuple{C, Base.Generator}} where {T, C&lt;:(ExaCore{T, VT} where VT&lt;:AbstractVector{T})}"><code>ExaModels.constraint</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">constraint(core, generator; start = 0, lcon = 0,  ucon = 0)</code></pre><p>Adds constraints specified by a <code>generator</code> to <code>core</code>, and returns an <code>Constraint</code> object.</p><p><strong>Keyword Arguments</strong></p><ul><li><code>start</code>: The initial guess of the dual solution. Can either be <code>Number</code>, <code>AbstractArray</code>, or <code>Generator</code>.</li><li><code>lcon</code> : The constraint lower bound. Can either be <code>Number</code>, <code>AbstractArray</code>, or <code>Generator</code>.</li><li><code>ucon</code> : The constraint upper bound. Can either be <code>Number</code>, <code>AbstractArray</code>, or <code>Generator</code>.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using ExaModels

julia&gt; c = ExaCore();

julia&gt; x = variable(c, 10);

julia&gt; constraint(c, x[i] + x[i+1] for i=1:9; lcon = -1, ucon = (1+i for i=1:9))
Constraint

  s.t. (...)
       g♭ ≤ [g(x,θ,p)]_{p ∈ P} ≤ g♯

  where |P| = 9</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/nlp.jl#L663-L689">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.constraint-Union{Tuple{N}, Tuple{C}, Tuple{T}, Tuple{C, N}, Tuple{C, N, Any}} where {T, C&lt;:(ExaCore{T, VT} where VT&lt;:AbstractVector{T}), N&lt;:ExaModels.AbstractNode}"><a class="docstring-binding" href="#ExaModels.constraint-Union{Tuple{N}, Tuple{C}, Tuple{T}, Tuple{C, N}, Tuple{C, N, Any}} where {T, C&lt;:(ExaCore{T, VT} where VT&lt;:AbstractVector{T}), N&lt;:ExaModels.AbstractNode}"><code>ExaModels.constraint</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">constraint(core, expr [, pars]; start = 0, lcon = 0,  ucon = 0)</code></pre><p>Adds constraints specified by a <code>expr</code> and <code>pars</code> to <code>core</code>, and returns an <code>Constraint</code> object.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/nlp.jl#L705-L709">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.design_var_index-Tuple{StochasticExaModel, Int64}"><a class="docstring-binding" href="#ExaModels.design_var_index-Tuple{StochasticExaModel, Int64}"><code>ExaModels.design_var_index</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">design_var_index(model, j) -&gt; global_idx</code></pre><p>Get global index for design variable j.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/stochastic.jl#L422-L426">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.drpass-Union{Tuple{D}, Tuple{D, Any, Any}} where D&lt;:ExaModels.AdjointNull"><a class="docstring-binding" href="#ExaModels.drpass-Union{Tuple{D}, Tuple{D, Any, Any}} where D&lt;:ExaModels.AdjointNull"><code>ExaModels.drpass</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">drpass(d::D, y, adj)</code></pre><p>Performs dense gradient evaluation via the reverse pass on the computation (sub)graph formed by forward pass</p><p><strong>Arguments:</strong></p><ul><li><code>d</code>: first-order computation (sub)graph</li><li><code>y</code>: result vector</li><li><code>adj</code>: adjoint propagated up to the current node</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/gradient.jl#L1-L10">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.extract_cons_block-Tuple{StochasticExaModel, Int64, AbstractVector}"><a class="docstring-binding" href="#ExaModels.extract_cons_block-Tuple{StochasticExaModel, Int64, AbstractVector}"><code>ExaModels.extract_cons_block</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">extract_cons_block(model::StochasticExaModel, i, c_global)</code></pre><p>Extract constraint block for scenario i from global constraint vector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/stochastic.jl#L307-L311">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.extract_design_vars-Tuple{StochasticExaModel, AbstractVector}"><a class="docstring-binding" href="#ExaModels.extract_design_vars-Tuple{StochasticExaModel, AbstractVector}"><code>ExaModels.extract_design_vars</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">extract_design_vars(model::StochasticExaModel, x_global)</code></pre><p>Extract design variables from global variable vector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/stochastic.jl#L365-L369">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.extract_grad_block-Tuple{StochasticExaModel, Int64, AbstractVector}"><a class="docstring-binding" href="#ExaModels.extract_grad_block-Tuple{StochasticExaModel, Int64, AbstractVector}"><code>ExaModels.extract_grad_block</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">extract_grad_block(model::StochasticExaModel, i, g_global)</code></pre><p>Extract gradient block for scenario i from global gradient. Returns (g<em>v, g</em>d) views of recourse and design gradient components.</p><p>Note: The design variable gradient accumulates contributions from all scenarios.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/stochastic.jl#L321-L328">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.extract_recourse_vars-Tuple{StochasticExaModel, Int64, AbstractVector}"><a class="docstring-binding" href="#ExaModels.extract_recourse_vars-Tuple{StochasticExaModel, Int64, AbstractVector}"><code>ExaModels.extract_recourse_vars</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">extract_recourse_vars(model::StochasticExaModel, i, x_global)</code></pre><p>Extract recourse variables for scenario i from global variable vector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/stochastic.jl#L349-L353">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.get_model-Tuple{StochasticExaModel}"><a class="docstring-binding" href="#ExaModels.get_model-Tuple{StochasticExaModel}"><code>ExaModels.get_model</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">get_model(model::StochasticExaModel)</code></pre><p>Get the underlying ExaModel for direct NLPModels interface usage.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/stochastic.jl#L485-L489">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.global_con_index-Tuple{StochasticExaModel, Int64, Int64}"><a class="docstring-binding" href="#ExaModels.global_con_index-Tuple{StochasticExaModel, Int64, Int64}"><code>ExaModels.global_con_index</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">global_con_index(model, i, local_idx) -&gt; global_idx</code></pre><p>Convert local constraint index to global index for scenario i.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/stochastic.jl#L404-L408">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.global_var_index-Tuple{StochasticExaModel, Int64, Int64}"><a class="docstring-binding" href="#ExaModels.global_var_index-Tuple{StochasticExaModel, Int64, Int64}"><code>ExaModels.global_var_index</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">global_var_index(model, i, local_idx) -&gt; global_idx</code></pre><p>Convert local variable index to global index for scenario i.</p><p>Local ordering (for scenario API): [d₁, ..., d<em>nd, v₁, ..., v</em>nv] Global ordering: [v₁¹...v<em>nv¹, v₁²...v</em>nv², ..., v₁ⁿˢ...v<em>nvⁿˢ, d₁...d</em>nd]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/stochastic.jl#L384-L391">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.gradient!-NTuple{5, Any}"><a class="docstring-binding" href="#ExaModels.gradient!-NTuple{5, Any}"><code>ExaModels.gradient!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">gradient!(y, f, x, adj)</code></pre><p>Performs dense gradient evalution</p><p><strong>Arguments:</strong></p><ul><li><code>y</code>: result vector</li><li><code>f</code>: the function to be differentiated in <code>SIMDFunction</code> format</li><li><code>x</code>: variable vector</li><li><code>adj</code>: initial adjoint</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/gradient.jl#L28-L38">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.grpass-Union{Tuple{D}, Tuple{D, Vararg{Any, 5}}} where D&lt;:Union{ExaModels.AdjointNull, Real, ExaModels.ParIndexed}"><a class="docstring-binding" href="#ExaModels.grpass-Union{Tuple{D}, Tuple{D, Vararg{Any, 5}}} where D&lt;:Union{ExaModels.AdjointNull, Real, ExaModels.ParIndexed}"><code>ExaModels.grpass</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">grpass(d::D, comp, y, o1, cnt, adj)</code></pre><p>Performs dsparse gradient evaluation via the reverse pass on the computation (sub)graph formed by forward pass</p><p><strong>Arguments:</strong></p><ul><li><code>d</code>: first-order computation (sub)graph</li><li><code>comp</code>: a <code>Compressor</code>, which helps map counter to sparse vector index</li><li><code>y</code>: result vector</li><li><code>o1</code>: index offset</li><li><code>cnt</code>: counter</li><li><code>adj</code>: adjoint propagated up to the current node</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/gradient.jl#L51-L63">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.hdrpass-Union{Tuple{T2}, Tuple{T1}, Tuple{T1, T2, Vararg{Any, 6}}} where {T1&lt;:ExaModels.SecondAdjointNode1, T2&lt;:ExaModels.SecondAdjointNode1}"><a class="docstring-binding" href="#ExaModels.hdrpass-Union{Tuple{T2}, Tuple{T1}, Tuple{T1, T2, Vararg{Any, 6}}} where {T1&lt;:ExaModels.SecondAdjointNode1, T2&lt;:ExaModels.SecondAdjointNode1}"><code>ExaModels.hdrpass</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">hdrpass(t1::T1, t2::T2, comp, y1, y2, o2, cnt, adj)</code></pre><p>Performs sparse hessian evaluation (<code>(df1/dx)(df2/dx)&#39;</code> portion) via the reverse pass on the computation (sub)graph formed by second-order forward pass</p><p><strong>Arguments:</strong></p><ul><li><code>t1</code>: second-order computation (sub)graph regarding f1</li><li><code>t2</code>: second-order computation (sub)graph regarding f2</li><li><code>comp</code>: a <code>Compressor</code>, which helps map counter to sparse vector index</li><li><code>y1</code>: result vector #1</li><li><code>y2</code>: result vector #2 (only used when evaluating sparsity)</li><li><code>o2</code>: index offset</li><li><code>cnt</code>: counter</li><li><code>adj</code>: second adjoint propagated up to the current node</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/hessian.jl#L1-L15">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.jrpass-Union{Tuple{D}, Tuple{D, Vararg{Any, 7}}} where D&lt;:Union{ExaModels.AdjointNull, Real}"><a class="docstring-binding" href="#ExaModels.jrpass-Union{Tuple{D}, Tuple{D, Vararg{Any, 7}}} where D&lt;:Union{ExaModels.AdjointNull, Real}"><code>ExaModels.jrpass</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">jrpass(d::D, comp, i, y1, y2, o1, cnt, adj)</code></pre><p>Performs sparse jacobian evaluation via the reverse pass on the computation (sub)graph formed by forward pass</p><p><strong>Arguments:</strong></p><ul><li><code>d</code>: first-order computation (sub)graph</li><li><code>comp</code>: a <code>Compressor</code>, which helps map counter to sparse vector index</li><li><code>i</code>: constraint index (this is <code>i</code>-th constraint)</li><li><code>y1</code>: result vector #1</li><li><code>y2</code>: result vector #2 (only used when evaluating sparsity)</li><li><code>o1</code>: index offset</li><li><code>cnt</code>: counter</li><li><code>adj</code>: adjoint propagated up to the current node</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/jacobian.jl#L1-L15">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.multipliers-Tuple{SolverCore.AbstractExecutionStats, ExaModels.Constraint}"><a class="docstring-binding" href="#ExaModels.multipliers-Tuple{SolverCore.AbstractExecutionStats, ExaModels.Constraint}"><code>ExaModels.multipliers</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">multipliers(result, y)</code></pre><p>Returns the multipliers for constraints <code>y</code> associated with <code>result</code>, obtained by solving the model.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using ExaModels, NLPModelsIpopt

julia&gt; c = ExaCore();

julia&gt; x = variable(c, 1:10, lvar = -1, uvar = 1);

julia&gt; objective(c, (x[i]-2)^2 for i in 1:10);

julia&gt; y = constraint(c, x[i] + x[i+1] for i=1:9; lcon = -1, ucon = (1+i for i=1:9));

julia&gt; m = ExaModel(c);

julia&gt; result = ipopt(m; print_level=0);

julia&gt; val = multipliers(result, y);


julia&gt; val[1] ≈ 0.81933930
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/nlp.jl#L1223-L1250">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.multipliers_L-Tuple{SolverCore.AbstractExecutionStats, Any}"><a class="docstring-binding" href="#ExaModels.multipliers_L-Tuple{SolverCore.AbstractExecutionStats, Any}"><code>ExaModels.multipliers_L</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">multipliers_L(result, x)</code></pre><p>Returns the multipliers_L for variable <code>x</code> associated with <code>result</code>, obtained by solving the model.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using ExaModels, NLPModelsIpopt

julia&gt; c = ExaCore();

julia&gt; x = variable(c, 1:10, lvar = -1, uvar = 1);

julia&gt; objective(c, (x[i]-2)^2 for i in 1:10);

julia&gt; m = ExaModel(c);

julia&gt; result = ipopt(m; print_level=0);

julia&gt; val = multipliers_L(result, x);

julia&gt; isapprox(val, fill(0, 10), atol=sqrt(eps(Float64)), rtol=Inf)
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/nlp.jl#L1184-L1208">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.multipliers_U-Tuple{SolverCore.AbstractExecutionStats, Any}"><a class="docstring-binding" href="#ExaModels.multipliers_U-Tuple{SolverCore.AbstractExecutionStats, Any}"><code>ExaModels.multipliers_U</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">multipliers_U(result, x)</code></pre><p>Returns the multipliers_U for variable <code>x</code> associated with <code>result</code>, obtained by solving the model.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using ExaModels, NLPModelsIpopt

julia&gt; c = ExaCore();

julia&gt; x = variable(c, 1:10, lvar = -1, uvar = 1);

julia&gt; objective(c, (x[i]-2)^2 for i in 1:10);

julia&gt; m = ExaModel(c);

julia&gt; result = ipopt(m; print_level=0);

julia&gt; val = multipliers_U(result, x);

julia&gt; isapprox(val, fill(2, 10), atol=sqrt(eps(Float64)), rtol=Inf)
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/nlp.jl#L1184-L1208">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.objective-Union{Tuple{C}, Tuple{C, Any}} where C&lt;:ExaCore"><a class="docstring-binding" href="#ExaModels.objective-Union{Tuple{C}, Tuple{C, Any}} where C&lt;:ExaCore"><code>ExaModels.objective</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">objective(core::ExaCore, generator)</code></pre><p>Adds objective terms specified by a <code>generator</code> to <code>core</code>, and returns an <code>Objective</code> object. Note: it is assumed that the terms are summed.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using ExaModels

julia&gt; c = ExaCore();

julia&gt; x = variable(c, 10);

julia&gt; objective(c, x[i]^2 for i=1:10)
Objective

  min (...) + ∑_{p ∈ P} f(x,θ,p)

  where |P| = 10</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/nlp.jl#L614-L634">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.objective-Union{Tuple{N}, Tuple{C}, Tuple{C, N}, Tuple{C, N, Any}} where {C&lt;:ExaCore, N&lt;:ExaModels.AbstractNode}"><a class="docstring-binding" href="#ExaModels.objective-Union{Tuple{N}, Tuple{C}, Tuple{C, N}, Tuple{C, N, Any}} where {C&lt;:ExaCore, N&lt;:ExaModels.AbstractNode}"><code>ExaModels.objective</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">objective(core::ExaCore, expr [, pars])</code></pre><p>Adds objective terms specified by a <code>expr</code> and <code>pars</code> to <code>core</code>, and returns an <code>Objective</code> object.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/nlp.jl#L643-L647">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.parameter-Union{Tuple{C}, Tuple{T}, Tuple{C, AbstractArray}} where {T, C&lt;:(ExaCore{T, VT} where VT&lt;:AbstractVector{T})}"><a class="docstring-binding" href="#ExaModels.parameter-Union{Tuple{C}, Tuple{T}, Tuple{C, AbstractArray}} where {T, C&lt;:(ExaCore{T, VT} where VT&lt;:AbstractVector{T})}"><code>ExaModels.parameter</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">parameter(core, start::AbstractArray)</code></pre><p>Adds parameters with initial values specified by <code>start</code>, and returns <code>Parameter</code> object.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using ExaModels

julia&gt; c = ExaCore();

julia&gt; θ = parameter(c, ones(10))
Parameter

  θ ∈ R^{10}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/nlp.jl#L523-L539">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.recourse_var_index-Tuple{StochasticExaModel, Int64, Int64}"><a class="docstring-binding" href="#ExaModels.recourse_var_index-Tuple{StochasticExaModel, Int64, Int64}"><code>ExaModels.recourse_var_index</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">recourse_var_index(model, i, j) -&gt; global_idx</code></pre><p>Get global index for recourse variable j of scenario i.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/stochastic.jl#L413-L417">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.set_all_scenario_parameters!-Tuple{StochasticExaModel, Vector{&lt;:AbstractVector}}"><a class="docstring-binding" href="#ExaModels.set_all_scenario_parameters!-Tuple{StochasticExaModel, Vector{&lt;:AbstractVector}}"><code>ExaModels.set_all_scenario_parameters!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">set_all_scenario_parameters!(model, θ_sets)</code></pre><p>Update parameters for all scenarios.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/stochastic.jl#L461-L465">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.set_parameter!-Tuple{ExaCore, ExaModels.Parameter, AbstractArray}"><a class="docstring-binding" href="#ExaModels.set_parameter!-Tuple{ExaCore, ExaModels.Parameter, AbstractArray}"><code>ExaModels.set_parameter!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">set_parameter!(core, param, values)</code></pre><p>Updates the values of parameters in the core.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using ExaModels

julia&gt; c = ExaCore();

julia&gt; p = parameter(c, ones(5))
Parameter

  θ ∈ R^{5}

julia&gt; set_parameter!(c, p, rand(5))  # Update with new values</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/nlp.jl#L551-L569">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.set_scenario_parameters!-Tuple{StochasticExaModel, Int64, AbstractVector}"><a class="docstring-binding" href="#ExaModels.set_scenario_parameters!-Tuple{StochasticExaModel, Int64, AbstractVector}"><code>ExaModels.set_scenario_parameters!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">set_scenario_parameters!(model, i, θ_new)</code></pre><p>Update parameters for scenario i.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/stochastic.jl#L435-L439">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.sgradient!-NTuple{5, Any}"><a class="docstring-binding" href="#ExaModels.sgradient!-NTuple{5, Any}"><code>ExaModels.sgradient!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>sgradient!(y, f, x, adj)</p><p>Performs sparse gradient evalution</p><p><strong>Arguments:</strong></p><ul><li><code>y</code>: result vector</li><li><code>f</code>: the function to be differentiated in <code>SIMDFunction</code> format</li><li><code>x</code>: variable vector</li><li><code>adj</code>: initial adjoint</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/gradient.jl#L104-L114">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.shessian!-NTuple{7, Any}"><a class="docstring-binding" href="#ExaModels.shessian!-NTuple{7, Any}"><code>ExaModels.shessian!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">shessian!(y1, y2, f, x, adj1, adj2)</code></pre><p>Performs sparse jacobian evalution</p><p><strong>Arguments:</strong></p><ul><li><code>y1</code>: result vector #1</li><li><code>y2</code>: result vector #2 (only used when evaluating sparsity)</li><li><code>f</code>: the function to be differentiated in <code>SIMDFunction</code> format</li><li><code>x</code>: variable vector</li><li><code>adj1</code>: initial first adjoint</li><li><code>adj2</code>: initial second adjoint</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/hessian.jl#L617-L629">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.sjacobian!-NTuple{6, Any}"><a class="docstring-binding" href="#ExaModels.sjacobian!-NTuple{6, Any}"><code>ExaModels.sjacobian!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">sjacobian!(y1, y2, f, x, adj)</code></pre><p>Performs sparse jacobian evalution</p><p><strong>Arguments:</strong></p><ul><li><code>y1</code>: result vector #1</li><li><code>y2</code>: result vector #2 (only used when evaluating sparsity)</li><li><code>f</code>: the function to be differentiated in <code>SIMDFunction</code> format</li><li><code>x</code>: variable vector</li><li><code>adj</code>: initial adjoint</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/jacobian.jl#L100-L111">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.solution-Tuple{SolverCore.AbstractExecutionStats, Any}"><a class="docstring-binding" href="#ExaModels.solution-Tuple{SolverCore.AbstractExecutionStats, Any}"><code>ExaModels.solution</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">solution(result, x)</code></pre><p>Returns the solution for variable <code>x</code> associated with <code>result</code>, obtained by solving the model.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using ExaModels, NLPModelsIpopt

julia&gt; c = ExaCore();

julia&gt; x = variable(c, 1:10, lvar = -1, uvar = 1);

julia&gt; objective(c, (x[i]-2)^2 for i in 1:10);

julia&gt; m = ExaModel(c);

julia&gt; result = ipopt(m; print_level=0);

julia&gt; val = solution(result, x);

julia&gt; isapprox(val, fill(1, 10), atol=sqrt(eps(Float64)), rtol=Inf)
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/nlp.jl#L1184-L1208">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.subexpr-Union{Tuple{C}, Tuple{T}, Tuple{C, Base.Generator}} where {T, C&lt;:(ExaCore{T, VT} where VT&lt;:AbstractVector{T})}"><a class="docstring-binding" href="#ExaModels.subexpr-Union{Tuple{C}, Tuple{T}, Tuple{C, Base.Generator}} where {T, C&lt;:(ExaCore{T, VT} where VT&lt;:AbstractVector{T})}"><code>ExaModels.subexpr</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">subexpr(core, generator; reduced=false, parameter_only=false)</code></pre><p>Creates a subexpression that can be reused in objectives and constraints.</p><p>Three forms are available:</p><ul><li><p><strong>Lifted</strong> (default, <code>reduced=false</code>): Creates auxiliary variables with defining equality constraints. This generates derivative code once and uses simple variable references thereafter. Adds variables and constraints to the problem.</p></li><li><p><strong>Reduced</strong> (<code>reduced=true</code>): Stores the expression for direct substitution when indexed. No auxiliary variables or constraints are created. The expression is inlined wherever used.</p></li><li><p><strong>Parameter-only</strong> (<code>parameter_only=true</code>): For expressions that depend only on parameters (θ), not variables (x). Values are computed once when parameters are set, not at every function evaluation. Automatically recomputed when <code>set_parameter!</code> is called.</p></li></ul><p>Both lifted and reduced forms support SIMD-vectorized evaluation and can be nested.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using ExaModels

julia&gt; c = ExaCore();

julia&gt; x = variable(c, 10);

julia&gt; s = subexpr(c, x[i]^2 for i in 1:10)
Subexpression (lifted)

  s ∈ R^{10}

julia&gt; objective(c, s[i] + s[i+1] for i in 1:9);</code></pre><p><strong>Reduced form (experimental)</strong></p><div class="admonition is-warning" id="Warning-afb4103ba277240"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-afb4103ba277240" title="Permalink"></a></header><div class="admonition-body"><p>The reduced form (<code>reduced=true</code>) is experimental and may have issues with complex nested expressions. Use the default lifted form for production code.</p></div></div><pre><code class="language-julia hljs">c = ExaCore()
x = variable(c, 10)

# Reduced form - no extra variables/constraints
s = subexpr(c, x[i]^2 for i in 1:10; reduced=true)

# s[i] substitutes x[i]^2 directly into the expression
objective(c, s[i] + s[i+1] for i in 1:9)</code></pre><p><strong>Parameter-only form</strong></p><p>For expressions involving only parameters, use <code>parameter_only=true</code> to evaluate them once when parameters change, rather than at every optimization iteration:</p><pre><code class="language-julia hljs">c = ExaCore()
θ = parameter(c, ones(10))
x = variable(c, 10)

# Parameter-only subexpression - computed once per parameter update
weights = subexpr(c, θ[i]^2 + θ[i+1] for i in 1:9; parameter_only=true)

# Use in objective - weights[i] returns cached value, not re-computed
objective(c, weights[i] * x[i]^2 for i in 1:9)</code></pre><p><strong>Multi-dimensional example</strong></p><pre><code class="language-julia hljs">c = ExaCore()
x = variable(c, 0:T, 0:N)

# Automatically infers 2D structure from Cartesian product
dx = subexpr(c, x[t, i] - x[t-1, i] for t in 1:T, i in 1:N)

# Now dx[t, i] can be used in constraints
constraint(c, dx[t, i] - something for t in 1:T, i in 1:N)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/nlp.jl#L824-L905">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.variable-Union{Tuple{C}, Tuple{T}, Tuple{C, Vararg{Any}}} where {T, C&lt;:(ExaCore{T, VT} where VT&lt;:AbstractVector{T})}"><a class="docstring-binding" href="#ExaModels.variable-Union{Tuple{C}, Tuple{T}, Tuple{C, Vararg{Any}}} where {T, C&lt;:(ExaCore{T, VT} where VT&lt;:AbstractVector{T})}"><code>ExaModels.variable</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">variable(core, dims...; start = 0, lvar = -Inf, uvar = Inf)</code></pre><p>Adds variables with dimensions specified by <code>dims</code> to <code>core</code>, and returns <code>Variable</code> object. <code>dims</code> can be either <code>Integer</code> or <code>UnitRange</code>.</p><p><strong>Keyword Arguments</strong></p><ul><li><code>start</code>: The initial guess of the solution. Can either be <code>Number</code>, <code>AbstractArray</code>, or <code>Generator</code>.</li><li><code>lvar</code> : The variable lower bound. Can either be <code>Number</code>, <code>AbstractArray</code>, or <code>Generator</code>.</li><li><code>uvar</code> : The variable upper bound. Can either be <code>Number</code>, <code>AbstractArray</code>, or <code>Generator</code>.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using ExaModels

julia&gt; c = ExaCore();

julia&gt; x = variable(c, 10; start = (sin(i) for i=1:10))
Variable

  x ∈ R^{10}

julia&gt; y = variable(c, 2:10, 3:5; lvar = zeros(9,3), uvar = ones(9,3))
Variable

  x ∈ R^{9 × 3}
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/nlp.jl#L474-L502">source</a></section></details></article><article><details class="docstring" open="true"><summary id="NLPModels.cons!-Tuple{StochasticExaModel, AbstractVector, AbstractVector}"><a class="docstring-binding" href="#NLPModels.cons!-Tuple{StochasticExaModel, AbstractVector, AbstractVector}"><code>NLPModels.cons!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">cons!(model::StochasticExaModel, x_global, c_global)</code></pre><p>Evaluate all constraints. Output: c_global ∈ ℝ^{ns*nc}</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/stochastic.jl#L183-L188">source</a></section></details></article><article><details class="docstring" open="true"><summary id="NLPModels.get_ncon-Tuple{StochasticExaModel}"><a class="docstring-binding" href="#NLPModels.get_ncon-Tuple{StochasticExaModel}"><code>NLPModels.get_ncon</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">get_ncon(model::StochasticExaModel)</code></pre><p>Total number of constraints.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/stochastic.jl#L296-L300">source</a></section></details></article><article><details class="docstring" open="true"><summary id="NLPModels.get_nnzh-Tuple{StochasticExaModel}"><a class="docstring-binding" href="#NLPModels.get_nnzh-Tuple{StochasticExaModel}"><code>NLPModels.get_nnzh</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">get_nnzh(model::StochasticExaModel)</code></pre><p>Total number of Hessian nonzeros.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/stochastic.jl#L282-L286">source</a></section></details></article><article><details class="docstring" open="true"><summary id="NLPModels.get_nnzj-Tuple{StochasticExaModel}"><a class="docstring-binding" href="#NLPModels.get_nnzj-Tuple{StochasticExaModel}"><code>NLPModels.get_nnzj</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">get_nnzj(model::StochasticExaModel)</code></pre><p>Total number of Jacobian nonzeros.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/stochastic.jl#L275-L279">source</a></section></details></article><article><details class="docstring" open="true"><summary id="NLPModels.get_nvar-Tuple{StochasticExaModel}"><a class="docstring-binding" href="#NLPModels.get_nvar-Tuple{StochasticExaModel}"><code>NLPModels.get_nvar</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">get_nvar(model::StochasticExaModel)</code></pre><p>Total number of variables.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/stochastic.jl#L289-L293">source</a></section></details></article><article><details class="docstring" open="true"><summary id="NLPModels.grad!-Tuple{StochasticExaModel, AbstractVector, AbstractVector}"><a class="docstring-binding" href="#NLPModels.grad!-Tuple{StochasticExaModel, AbstractVector, AbstractVector}"><code>NLPModels.grad!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">grad!(model::StochasticExaModel, x_global, g_global)</code></pre><p>Evaluate total gradient. Output: g_global ∈ ℝ^{ns*nv + nd}</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/stochastic.jl#L198-L203">source</a></section></details></article><article><details class="docstring" open="true"><summary id="NLPModels.hess_coord!-Tuple{StochasticExaModel, AbstractVector, AbstractVector, AbstractVector}"><a class="docstring-binding" href="#NLPModels.hess_coord!-Tuple{StochasticExaModel, AbstractVector, AbstractVector, AbstractVector}"><code>NLPModels.hess_coord!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">hess_coord!(model::StochasticExaModel, x_global, y_global, hess_global; obj_weight=1.0)</code></pre><p>Evaluate full Hessian of Lagrangian (COO values).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/stochastic.jl#L241-L245">source</a></section></details></article><article><details class="docstring" open="true"><summary id="NLPModels.hess_structure!-Tuple{StochasticExaModel, AbstractVector{&lt;:Integer}, AbstractVector{&lt;:Integer}}"><a class="docstring-binding" href="#NLPModels.hess_structure!-Tuple{StochasticExaModel, AbstractVector{&lt;:Integer}, AbstractVector{&lt;:Integer}}"><code>NLPModels.hess_structure!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">hess_structure!(model::StochasticExaModel, rows, cols)</code></pre><p>Get full Hessian sparsity structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/stochastic.jl#L257-L261">source</a></section></details></article><article><details class="docstring" open="true"><summary id="NLPModels.jac_coord!-Tuple{StochasticExaModel, AbstractVector, AbstractVector}"><a class="docstring-binding" href="#NLPModels.jac_coord!-Tuple{StochasticExaModel, AbstractVector, AbstractVector}"><code>NLPModels.jac_coord!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">jac_coord!(model::StochasticExaModel, x_global, jac_global)</code></pre><p>Evaluate full Jacobian (COO values).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/stochastic.jl#L213-L217">source</a></section></details></article><article><details class="docstring" open="true"><summary id="NLPModels.jac_structure!-Tuple{StochasticExaModel, AbstractVector{&lt;:Integer}, AbstractVector{&lt;:Integer}}"><a class="docstring-binding" href="#NLPModels.jac_structure!-Tuple{StochasticExaModel, AbstractVector{&lt;:Integer}, AbstractVector{&lt;:Integer}}"><code>NLPModels.jac_structure!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">jac_structure!(model::StochasticExaModel, rows, cols)</code></pre><p>Get full Jacobian sparsity structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/stochastic.jl#L227-L231">source</a></section></details></article><article><details class="docstring" open="true"><summary id="NLPModels.obj-Tuple{StochasticExaModel, AbstractVector}"><a class="docstring-binding" href="#NLPModels.obj-Tuple{StochasticExaModel, AbstractVector}"><code>NLPModels.obj</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">obj(model::StochasticExaModel, x_global)</code></pre><p>Evaluate total objective (sum over all scenarios).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/stochastic.jl#L174-L178">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.@register_bivariate-NTuple{6, Any}"><a class="docstring-binding" href="#ExaModels.@register_bivariate-NTuple{6, Any}"><code>ExaModels.@register_bivariate</code></a> — <span class="docstring-category">Macro</span></summary><section><div><pre><code class="language-julia hljs">register_bivariate(f, df1, df2, ddf11, ddf12, ddf22)</code></pre><p>Register a bivariate function <code>f</code> to <code>ExaModels</code>, so that it can be used within objective and constraint expressions</p><p><strong>Arguments:</strong></p><ul><li><code>f</code>: function</li><li><code>df1</code>: derivative function (w.r.t. first argument)</li><li><code>df2</code>: derivative function (w.r.t. second argument)</li><li><code>ddf11</code>: second-order derivative funciton (w.r.t. first argument)</li><li><code>ddf12</code>: second-order derivative funciton (w.r.t. first and second argument)</li><li><code>ddf22</code>: second-order derivative funciton (w.r.t. second argument)</li></ul><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using ExaModels

julia&gt; relu23(x,y) = (x &gt; 0 || y &gt; 0) ? (x + y)^3 : zero(x)
relu23 (generic function with 1 method)

julia&gt; drelu231(x,y) = (x &gt; 0 || y &gt; 0) ? 3 * (x + y)^2 : zero(x)
drelu231 (generic function with 1 method)

julia&gt; drelu232(x,y) = (x &gt; 0 || y &gt; 0) ? 3 * (x + y)^2  : zero(x)
drelu232 (generic function with 1 method)

julia&gt; ddrelu2311(x,y) = (x &gt; 0 || y &gt; 0) ? 6 * (x + y) : zero(x)
ddrelu2311 (generic function with 1 method)

julia&gt; ddrelu2312(x,y) = (x &gt; 0 || y &gt; 0) ? 6 * (x + y) : zero(x)
ddrelu2312 (generic function with 1 method)

julia&gt; ddrelu2322(x,y) = (x &gt; 0 || y &gt; 0) ? 6 * (x + y) : zero(x)
ddrelu2322 (generic function with 1 method)

julia&gt; @register_bivariate(relu23, drelu231, drelu232, ddrelu2311, ddrelu2312, ddrelu2322)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/register.jl#L45-L82">source</a></section></details></article><article><details class="docstring" open="true"><summary id="ExaModels.@register_univariate-Tuple{Any, Any, Any}"><a class="docstring-binding" href="#ExaModels.@register_univariate-Tuple{Any, Any, Any}"><code>ExaModels.@register_univariate</code></a> — <span class="docstring-category">Macro</span></summary><section><div><pre><code class="language-julia hljs">@register_univariate(f, df, ddf)</code></pre><p>Register a univariate function <code>f</code> to <code>ExaModels</code>, so that it can be used within objective and constraint expressions</p><p><strong>Arguments:</strong></p><ul><li><code>f</code>: function</li><li><code>df</code>: derivative function</li><li><code>ddf</code>: second-order derivative funciton</li></ul><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using ExaModels

julia&gt; relu3(x) = x &gt; 0 ? x^3 : zero(x)
relu3 (generic function with 1 method)

julia&gt; drelu3(x) = x &gt; 0 ? 3*x^2 : zero(x)
drelu3 (generic function with 1 method)

julia&gt; ddrelu3(x) = x &gt; 0 ? 6*x : zero(x)
ddrelu3 (generic function with 1 method)

julia&gt; @register_univariate(relu3, drelu3, ddrelu3)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/exanauts/ExaModels.jl/blob/8a17df5ef9ab89c745cfcfa2306d4ecb89a18037/src/register.jl#L1-L26">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../jump/">« JuMP Interface (experimental)</a><a class="docs-footer-nextpage" href="../ref/">References »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Tuesday 27 January 2026 15:42">Tuesday 27 January 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
